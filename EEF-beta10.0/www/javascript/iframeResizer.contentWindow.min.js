/*! iFrame Resizer (iframeSizer.contentWindow.min.js) - v3.1.1 - 2015-08-30
 *  Desc: Include this file in any page being loaded into an iframe
 *        to force the iframe to resize to the content size.
 *  Requires: iframeResizer.min.js on host page.
 *  Copyright: (c) 2015 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

!function(a){"use strict";function b(b,c,d){"addEventListener"in a?b.addEventListener(c,d,!1):"attachEvent"in a&&b.attachEvent("on"+c,d)}function c(a){var b,c,d,e=null,f=0,g=function(){f=qa(),e=null,d=a.apply(b,c),e||(b=c=null)};return function(){var h=qa();f||(f=h);var i=ka-(h-f);return b=this,c=arguments,0>=i||i>ka?(e&&(clearTimeout(e),e=null),f=h,d=a.apply(b,c),e||(b=c=null)):e||(e=setTimeout(g,i)),d}}function d(a){return ba+"["+da+"] "+a}function e(b){aa&&"object"==typeof a.console&&console.log(d(b))}function f(b){"object"==typeof a.console&&console.warn(d(b))}function g(){h(),e("Initialising iFrame ("+location.href+")"),i(),l(),k("background",N),k("padding",Q),t(),q(),r(),m(),v(),s(),$=u(),E("init","Init message from host page"),pa()}function h(){function a(a){return"true"===a?!0:!1}var b=Z.substr(ca).split(":");da=b[0],O=void 0!==b[1]?Number(b[1]):O,R=void 0!==b[2]?a(b[2]):R,aa=void 0!==b[3]?a(b[3]):aa,_=void 0!==b[4]?Number(b[4]):_,L=void 0!==b[6]?a(b[6]):L,P=b[7],X=void 0!==b[8]?b[8]:X,N=b[9],Q=b[10],ha=void 0!==b[11]?Number(b[11]):ha,$.enable=void 0!==b[12]?a(b[12]):!1,fa=void 0!==b[13]?b[13]:fa,na=void 0!==b[14]?b[14]:na}function i(){function b(){var b=a.iFrameResizer;e("Reading data from page: "+JSON.stringify(b)),oa=void 0!==b.messageCallback?b.messageCallback:oa,pa=void 0!==b.readyCallback?b.readyCallback:pa,ga=void 0!==b.targetOrigin?b.targetOrigin:ga,X=void 0!==b.heightCalculationMethod?b.heightCalculationMethod:X,na=void 0!==b.widthCalculationMethod?b.widthCalculationMethod:na}"iFrameResizer"in a&&Object===a.iFrameResizer.constructor&&b()}function j(a,b){return-1!==b.indexOf("-")&&(f("Negative CSS value ignored for "+a),b=""),b}function k(a,b){void 0!==b&&""!==b&&"null"!==b&&(document.body.style[a]=b,e("Body "+a+' set to "'+b+'"'))}function l(){void 0===P&&(P=O+"px"),j("margin",P),k("margin",P)}function m(){document.documentElement.style.height="",document.body.style.height="",e('HTML & body height set to "auto"')}function n(c){function d(d){function e(){E(c.eventName,c.eventType)}b(a,d,e)}c.eventNames&&Array.prototype.map?(c.eventName=c.eventNames[0],c.eventNames.map(d)):d(c.eventName),e("Added event listener: "+c.eventType)}function o(){n({eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),n({eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),n({eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),n({eventType:"Orientation Change",eventName:"orientationchange"}),n({eventType:"Input",eventName:"input"}),n({eventType:"Print",eventName:["afterprint","beforeprint"]}),n({eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),n({eventType:"Mouse Up",eventName:"mouseup"}),n({eventType:"Mouse Down",eventName:"mousedown"}),"child"===fa&&n({eventType:"IFrame Resized",eventName:"resize"})}function p(a,b,c,d){b!==a&&(a in c||(f(a+" is not a valid option for "+d+"CalculationMethod."),a=b),e(d+' calculation method set to "'+a+'"'))}function q(){p(X,W,ra,"height")}function r(){p(na,ma,sa,"width")}function s(){!0===L?(o(),x()):e("Auto Resize disabled")}function t(){var a=document.createElement("div");a.style.clear="both",a.style.display="block",document.body.appendChild(a)}function u(){function c(){return{x:void 0!==a.pageXOffset?a.pageXOffset:document.documentElement.scrollLeft,y:void 0!==a.pageYOffset?a.pageYOffset:document.documentElement.scrollTop}}function d(a){var b=a.getBoundingClientRect(),d=c();return{x:parseInt(b.left,10)+parseInt(d.x,10),y:parseInt(b.top,10)+parseInt(d.y,10)}}function g(a){function b(a){var b=d(a);e("Moving to in page link (#"+c+") at x: "+b.x+" y: "+b.y),I(b.y,b.x,"scrollToOffset")}var c=a.split("#")[1]||a,f=decodeURIComponent(c),g=document.getElementById(f)||document.getElementsByName(f)[0];g?b(g):(e("In page link (#"+c+") not found in iFrame, so sending to parent"),I(0,0,"inPageLink","#"+c))}function h(){""!==location.hash&&"#"!==location.hash&&g(location.href)}function i(){function a(a){function c(a){a.preventDefault(),g(this.getAttribute("href"))}"#"!==a.getAttribute("href")&&b(a,"click",c)}Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),a)}function j(){b(a,"hashchange",h)}function k(){setTimeout(h,T)}function l(){Array.prototype.forEach&&document.querySelectorAll?(e("Setting up location.hash handlers"),i(),j(),k()):f("In page linking not fully supported in this browser! (See README.md for IE8 workaround)")}return $.enable?l():e("In page linking not enabled"),{findTarget:g}}function v(){e("Enable public methods"),a.parentIFrame={close:function(){I(0,0,"close")},getId:function(){return da},moveToAnchor:function(a){$.findTarget(a)},reset:function(){H("parentIFrame.reset")},scrollTo:function(a,b){I(b,a,"scrollTo")},scrollToOffset:function(a,b){I(b,a,"scrollToOffset")},sendMessage:function(a,b){I(0,0,"message",JSON.stringify(a),b)},setHeightCalculationMethod:function(a){X=a,q()},setWidthCalculationMethod:function(a){na=a,r()},setTargetOrigin:function(a){e("Set targetOrigin: "+a),ga=a},size:function(a,b){var c=""+(a?a:"")+(b?","+b:"");F(),E("size","parentIFrame.size("+c+")",a,b)}}}function w(){0!==_&&(e("setInterval: "+_+"ms"),setInterval(function(){E("interval","setInterval: "+_)},Math.abs(_)))}function x(){function b(a){function b(a){a.complete===!1&&(e("Attach listeners to "+a.src),a.addEventListener("load",c,!1),a.addEventListener("error",c,!1))}"attributes"===a.type&&"src"===a.attributeName?b(a.target):"childList"===a.type&&Array.prototype.forEach.call(a.target.querySelectorAll("img"),b)}function c(a){a.target.removeEventListener("load",c,!1),a.target.removeEventListener("error",c,!1),E("imageLoad","Image loaded: "+a.target.src,void 0,void 0)}function d(a){E("mutationObserver","mutationObserver: "+a[0].target+" "+a[0].type),a.forEach(b)}function g(){var a=document.querySelector("body"),b={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},c=new i(d);e("Enable MutationObserver"),c.observe(a,b)}var h=0>_,i=a.MutationObserver||a.WebKitMutationObserver;i?h?w():g():(f("MutationObserver not supported in this browser!"),w())}function y(a){function b(a){var b=/^\d+(px)?$/i;if(b.test(a))return parseInt(a,M);var d=c.style.left,e=c.runtimeStyle.left;return c.runtimeStyle.left=c.currentStyle.left,c.style.left=a||0,a=c.style.pixelLeft,c.style.left=d,c.runtimeStyle.left=e,a}var c=document.body,d=0;return"defaultView"in document&&"getComputedStyle"in document.defaultView?(d=document.defaultView.getComputedStyle(c,null),d=null!==d?d[a]:0):d=b(c.currentStyle[a]),parseInt(d,M)}function z(a,b){for(var c=b.length,d=0,f=qa(),g=0;c>g;g++)b[g].getBoundingClientRect()[a]>d&&(d=b[g].getBoundingClientRect()[a]);return f=qa()-f,e("Parsed "+c+" HTML elements"),e("Element position calculated in "+f+"ms"),f>ka/2&&(ka=2*f,e("Event throttle increased to "+ka+"ms")),d}function A(a){return[a.bodyOffset(),a.bodyScroll(),a.documentElementOffset(),a.documentElementScroll()]}function B(a,b){function c(){return f("No tagged elements ("+b+") found on page"),V}var d=document.querySelectorAll("["+b+"]");return 0===d.length?c():z(a,d)}function C(){return document.querySelectorAll("body *")}function D(a,b,c,d){function f(){V=l,la=m,I(V,la,a)}function g(){function a(a,b){var c=Math.abs(a-b)<=ha;return!c}return l=void 0!==c?c:ra[X](),m=void 0!==d?d:sa[na](),a(V,l)||R&&a(la,m)}function h(){return!(a in{init:1,interval:1,size:1})}function i(){return X in ea||R&&na in ea}function j(){e("No change in size detected")}function k(){h()&&i()?H(b):a in{interval:1}||j()}var l,m;g()||"init"===a?(F(),f()):k()}function E(a,b,c,d){function f(){a in{reset:1,resetPage:1,init:1}||e("Trigger event: "+b)}function g(){return ia&&a in S}g()?e("Trigger event cancelled: "+a):(f(),ta(a,b,c,d))}function F(){ia||(ia=!0,e("Trigger event lock on")),clearTimeout(ja),ja=setTimeout(function(){ia=!1,e("Trigger event lock off"),e("--")},T)}function G(a){V=ra[X](),la=sa[na](),I(V,la,a)}function H(a){var b=X;X=W,e("Reset trigger event: "+a),F(),G("reset"),X=b}function I(b,c,d,f,g){function h(){void 0===g?g=ga:e("Message targetOrigin: "+g)}function i(){var h=b+":"+c,i=da+":"+h+":"+d+(void 0!==f?":"+f:"");e("Sending message to host page ("+i+")"),a.parent.postMessage(ba+i,g)}h(),i()}function J(b){function c(){return ba===(""+b.data).substr(0,ca)}function d(){Z=b.data,g(),U=!1,setTimeout(function(){Y=!1},T)}function f(){Y?e("Page reset ignored by init"):(e("Page size reset by host page"),G("resetPage"))}function h(){E("resizeParent","Parent window requested size check")}function i(){var a=k();$.findTarget(a)}function j(){return b.data.split("]")[1].split(":")[0]}function k(){return b.data.substr(b.data.indexOf(":")+1)}function l(){return"iFrameResize"in a}function m(){var a=k();e("MessageCallback called from parent: "+a),oa(JSON.parse(a)),e(" --")}function n(){return b.data.split(":")[2]in{"true":1,"false":1}}function o(){switch(j()){case"reset":f();break;case"resize":h();break;case"moveToAnchor":i();break;case"message":m();break;default:!l()&&!n()}}function p(){!1===U?o():n()?d():e('Ignored message of type "'+j()+'". Received before initialization.')}c()&&p()}function K(){"loading"!==document.readyState&&a.parent.postMessage("[iFrameResizerChild]Ready","*")}var L=!0,M=10,N="",O=0,P="",Q="",R=!1,S={resize:1,click:1},T=128,U=!0,V=1,W="bodyOffset",X=W,Y=!0,Z="",$={},_=32,aa=!1,ba="[iFrameSizer]",ca=ba.length,da="",ea={max:1,min:1,bodyScroll:1,documentElementScroll:1},fa="child",ga="*",ha=0,ia=!1,ja=null,ka=0,la=1,ma="scroll",na=ma,oa=function(){f("MessageCallback function not defined")},pa=function(){},qa=Date.now||function(){return(new Date).getTime()},ra={bodyOffset:function(){return document.body.offsetHeight+y("marginTop")+y("marginBottom")},offset:function(){return ra.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,A(ra))},min:function(){return Math.min.apply(null,A(ra))},grow:function(){return ra.max()},lowestElement:function(){return Math.max(ra.bodyOffset(),z("bottom",C()))},taggedElement:function(){return B("bottom","data-iframe-height")}},sa={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(sa.bodyScroll(),sa.documentElementScroll())},max:function(){return Math.max.apply(null,A(sa))},min:function(){return Math.min.apply(null,A(sa))},leftMostElement:function(){return z("left",C())},taggedElement:function(){return B("left","data-iframe-width")}},ta=c(D);b(a,"message",J),K()}(window||{});
//# sourceMappingURL=iframeResizer.contentWindow.map